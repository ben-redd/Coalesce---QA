steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-0166fdb3-1bdc-47f5-b9a9-bd826149b058:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 305d4985-4c10-4561-b6e7-929d6d73f405
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1ce59a55-67c8-4f0e-8b1d-925e9fecc2d5
                    stepCounter: 6c31f0a1-942e-4641-9357-972f072fb5e6
                transform: ""
          - columnReference:
              columnCounter: f0810849-bb7e-4f19-8719-d572148a5660
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d516c8ec-eb2d-4656-9994-7eb51979665e
                    stepCounter: f547a8f6-5bac-4b83-97cb-7ffe9f163e26
                transform: ""
          - columnReference:
              columnCounter: d2d86972-a9af-4dda-b283-124aacf7e7db
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 07f74695-7989-4575-831d-9ed94ee5bc2e
                    stepCounter: b143397b-368c-4738-8640-e27fe1749c5e
                transform: ""
          - columnReference:
              columnCounter: 488d2a10-1e18-4077-9fdf-8c89ca0b0243
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1b2489b1-7428-41c4-8fd8-3332580b42d4
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 472ef3a9-29cc-40cf-a532-7fe910964f07
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ca0654d6-2963-40be-876c-f4ca04ba7fb4
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 3d36678c-6eb9-48c0-a5cf-315285d1fbd4
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3e8b9f9c-0229-4b4d-b57b-cf1a8c63b8e1
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 9e42f0c3-fdbf-4ed9-8955-0f0622ea9069
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 947c8463-cc7d-43d6-843e-4d7033873b21
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 082d9ce5-0c2c-4a8f-b02d-128fc2fd4d3e
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5efa42f3-67f6-4c72-960e-1b458ee4ae8d
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 4d7af09d-3c3b-4130-8877-da61ee0a283d
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 888004eb-22c6-4ae0-8eef-03e933d555f6
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 9219415c-3e3a-48b7-9007-d96e15db2229
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 64a59c2a-b4ee-4ede-939f-b283c82ed267
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 2a119d95-e59c-474d-8fbc-ae5c21444928
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4b335f9a-c4b1-4f69-b55e-46962ef54538
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 72eb1fd9-8ad2-4463-9144-cf5660d35fd1
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3826ded3-d449-4560-a00e-b9ca8f76ad17
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 7e01198e-0149-4cd0-b4c2-6a1c4435ecaa
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d6ea951b-b978-4d22-b582-fcf0e5c442e1
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 8e5cd7d6-6a22-45d4-8707-61b6f058140c
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dc5d48d0-dc3e-4196-8eb0-78a26cf89008
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 66506d17-98b8-486d-9437-510d7f0a7d42
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d6e41251-41c2-4aed-8c5e-d820916ee1ee
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: ef1a7973-ae8e-4b3b-8f30-adbf6af0f45c
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 73a3e9db-21ab-40e5-a078-b37a94af5445
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: a0d19d4b-a8fe-4216-8d6f-b8c0185310ad
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 329196eb-86d9-4568-a84d-34d8688907c1
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: a8e33264-e1df-426e-9c1e-56ebd69febec
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 27aabdf4-2f27-43ae-8712-f5d0df820892
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 2458940c-90e8-430a-9a76-af9a255ae4e6
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: af27fc29-5209-4087-871a-01ccd57b8e52
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: c1db1140-36da-4a08-81cf-07a61a2ddfed
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2d6c8d61-567b-4cf6-ac0d-a8aa5e1cf337
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 6b692898-39c9-46ba-a647-21bfcb83193c
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 302ef8e3-bb8d-42db-9927-2d5e866fdb0e
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: dc170c71-b7d7-4852-a736-a6c9df2e6ccd
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d471912a-ee38-4b55-a851-18c49a584267
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: bcbceac4-51ca-4cdd-bf9c-e01337a3aa40
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 96eaf63c-3be8-4fa2-92db-69173addedaa
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 91d653e3-5ab8-4f95-b92e-bfbd6595876a
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 800c3629-9b50-4206-a8ac-0e00d2c7551f
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 06f41a74-c4c2-496c-8601-bb748dde374b
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f8b5add8-26bf-4609-bc47-992acb3279e6
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: aa6b7b57-2124-475f-a544-37db7d11a38c
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY1_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 65c5f8d2-ef82-41ed-add9-a8fedde7c487
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 70285ab9-047f-46b4-af88-40db173519cf
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dc13bbbf-d5da-4f7a-bde6-9e0f9132f9f4
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 2e66246e-9640-4f71-8b83-ded55b356048
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 672ebccf-11ac-4fa3-a9a7-44a0383889d6
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: 07f870ec-e13e-4f95-82a3-c3dd5cc20a5b
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 939343ed-482b-4f78-86f1-326f49c9dd3e
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - columnReference:
              columnCounter: b9fd17e9-88a9-447c-bc94-a43a913e63ad
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS_TO_SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 75fc5828-837d-4604-8874-0ce2d9e0b736
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 9a6f5ad3-3a41-4e11-b74c-c1608a2b503b
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fcf25e02-ee96-4ee1-a314-d73e4a3b9e6c
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 03f3f70d-6cbd-4130-8d4c-f20a4e8986f5
              stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cf06da14-5192-443c-92da-95ae81cbea85
                    stepCounter: e6c87d63-b450-4c4e-a1b5-9d9654807b05
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 6c31f0a1-942e-4641-9357-972f072fb5e6
              DIM_PART: f547a8f6-5bac-4b83-97cb-7ffe9f163e26
              DIM_SUPPLIER: b143397b-368c-4738-8640-e27fe1749c5e
              STG_LINEITEM_ORDERS: e6c87d63-b450-4c4e-a1b5-9d9654807b05
              STG_PARTSUPP: 01c97fd1-0fbd-4e40-b0da-0293da585126
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"

                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"

                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"

                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"

                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */

                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"

                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"

                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"

                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND

                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 0166fdb3-1bdc-47f5-b9a9-bd826149b058
